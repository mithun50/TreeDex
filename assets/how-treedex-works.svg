<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 520" font-family="system-ui, -apple-system, sans-serif">
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#6366f1"/>
    </marker>
    <linearGradient id="headerGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#6366f1"/>
      <stop offset="100%" style="stop-color:#8b5cf6"/>
    </linearGradient>
    <filter id="shadow">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.1"/>
    </filter>
  </defs>

  <!-- Background -->
  <rect width="900" height="520" rx="12" fill="#fafafa"/>

  <!-- Title -->
  <rect x="0" y="0" width="900" height="56" rx="12" fill="url(#headerGrad)"/>
  <rect x="0" y="20" width="900" height="36" fill="url(#headerGrad)"/>
  <text x="450" y="36" text-anchor="middle" fill="white" font-size="20" font-weight="700">How TreeDex Works</text>

  <!-- Step 1: Document -->
  <rect x="40" y="80" width="150" height="80" rx="10" fill="white" stroke="#e2e8f0" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="115" y="112" text-anchor="middle" fill="#6366f1" font-size="24">ðŸ“„</text>
  <text x="115" y="136" text-anchor="middle" fill="#1e293b" font-size="13" font-weight="600">Document</text>
  <text x="115" y="152" text-anchor="middle" fill="#64748b" font-size="11">PDF / TXT / HTML / DOCX</text>

  <!-- Arrow 1 -->
  <line x1="190" y1="120" x2="230" y2="120" stroke="#6366f1" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Step 2: Pages -->
  <rect x="240" y="80" width="150" height="80" rx="10" fill="white" stroke="#e2e8f0" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="315" y="112" text-anchor="middle" fill="#6366f1" font-size="24">ðŸ“‘</text>
  <text x="315" y="136" text-anchor="middle" fill="#1e293b" font-size="13" font-weight="600">Extract Pages</text>
  <text x="315" y="152" text-anchor="middle" fill="#64748b" font-size="11">text + token counts</text>

  <!-- Arrow 2 -->
  <line x1="390" y1="120" x2="430" y2="120" stroke="#6366f1" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Step 3: Group -->
  <rect x="440" y="80" width="150" height="80" rx="10" fill="white" stroke="#e2e8f0" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="515" y="112" text-anchor="middle" fill="#6366f1" font-size="24">ðŸ“¦</text>
  <text x="515" y="136" text-anchor="middle" fill="#1e293b" font-size="13" font-weight="600">Group Pages</text>
  <text x="515" y="152" text-anchor="middle" fill="#64748b" font-size="11">token-budget chunks</text>

  <!-- Arrow 3 -->
  <line x1="590" y1="120" x2="630" y2="120" stroke="#6366f1" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Step 4: LLM -->
  <rect x="640" y="80" width="220" height="80" rx="10" fill="#ede9fe" stroke="#c4b5fd" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="750" y="112" text-anchor="middle" fill="#6366f1" font-size="24">ðŸ¤–</text>
  <text x="750" y="136" text-anchor="middle" fill="#4c1d95" font-size="13" font-weight="600">LLM: Extract Structure</text>
  <text x="750" y="152" text-anchor="middle" fill="#6d28d9" font-size="11">Any of 18+ providers</text>

  <!-- Arrow down from LLM -->
  <line x1="750" y1="160" x2="750" y2="200" stroke="#6366f1" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Step 5: Tree Building -->
  <rect x="580" y="210" width="280" height="80" rx="10" fill="white" stroke="#e2e8f0" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="720" y="240" text-anchor="middle" fill="#6366f1" font-size="24">ðŸŒ³</text>
  <text x="720" y="264" text-anchor="middle" fill="#1e293b" font-size="13" font-weight="600">Build Tree Index</text>
  <text x="720" y="280" text-anchor="middle" fill="#64748b" font-size="11">hierarchy + page ranges + embedded text</text>

  <!-- Arrow left from tree -->
  <line x1="580" y1="250" x2="530" y2="250" stroke="#6366f1" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Tree visualization -->
  <rect x="40" y="200" width="480" height="120" rx="10" fill="#f0fdf4" stroke="#86efac" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="280" y="224" text-anchor="middle" fill="#166534" font-size="12" font-weight="600">Tree Structure</text>

  <!-- Tree nodes -->
  <rect x="240" y="234" width="80" height="24" rx="4" fill="#22c55e" opacity="0.2" stroke="#22c55e" stroke-width="1"/>
  <text x="280" y="250" text-anchor="middle" fill="#166534" font-size="10">Document</text>

  <line x1="240" y1="258" x2="160" y2="270" stroke="#22c55e" stroke-width="1.5"/>
  <line x1="320" y1="258" x2="400" y2="270" stroke="#22c55e" stroke-width="1.5"/>

  <rect x="100" y="270" width="120" height="24" rx="4" fill="#22c55e" opacity="0.2" stroke="#22c55e" stroke-width="1"/>
  <text x="160" y="286" text-anchor="middle" fill="#166534" font-size="10">Ch 1 (p.0-17)</text>

  <rect x="340" y="270" width="120" height="24" rx="4" fill="#22c55e" opacity="0.2" stroke="#22c55e" stroke-width="1"/>
  <text x="400" y="286" text-anchor="middle" fill="#166534" font-size="10">Ch 2 (p.18-29)</text>

  <line x1="120" y1="294" x2="80" y2="302" stroke="#22c55e" stroke-width="1"/>
  <line x1="200" y1="294" x2="230" y2="302" stroke="#22c55e" stroke-width="1"/>

  <rect x="55" y="302" width="70" height="18" rx="3" fill="#22c55e" opacity="0.15" stroke="#22c55e" stroke-width="0.5"/>
  <text x="90" y="314" text-anchor="middle" fill="#166534" font-size="9">Sec 1.1</text>

  <rect x="195" y="302" width="70" height="18" rx="3" fill="#22c55e" opacity="0.15" stroke="#22c55e" stroke-width="0.5"/>
  <text x="230" y="314" text-anchor="middle" fill="#166534" font-size="9">Sec 1.2</text>

  <!-- Arrow down to query -->
  <line x1="280" y1="320" x2="280" y2="370" stroke="#6366f1" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Step 6: Query -->
  <rect x="40" y="380" width="360" height="80" rx="10" fill="#ede9fe" stroke="#c4b5fd" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="220" y="410" text-anchor="middle" fill="#6366f1" font-size="24">ðŸ’¬</text>
  <text x="220" y="434" text-anchor="middle" fill="#4c1d95" font-size="13" font-weight="600">Query: "What methods were used?"</text>
  <text x="220" y="450" text-anchor="middle" fill="#6d28d9" font-size="11">LLM selects relevant tree nodes</text>

  <!-- Arrow right to result -->
  <line x1="400" y1="420" x2="450" y2="420" stroke="#6366f1" stroke-width="2" marker-end="url(#arrow)"/>

  <!-- Step 7: Result -->
  <rect x="460" y="370" width="400" height="100" rx="10" fill="#fef3c7" stroke="#fbbf24" stroke-width="1.5" filter="url(#shadow)"/>
  <text x="660" y="400" text-anchor="middle" fill="#92400e" font-size="13" font-weight="700">QueryResult</text>
  <text x="660" y="420" text-anchor="middle" fill="#78350f" font-size="11">.context = "Methods section text..."</text>
  <text x="660" y="436" text-anchor="middle" fill="#78350f" font-size="11">.pages_str = "pages 18-25"</text>
  <text x="660" y="452" text-anchor="middle" fill="#78350f" font-size="11">.reasoning = "Section 2 covers methodology"</text>
  <text x="660" y="468" text-anchor="middle" fill="#78350f" font-size="11">.node_ids = ["0007", "0008"]</text>

  <!-- Bottom label -->
  <text x="450" y="510" text-anchor="middle" fill="#94a3b8" font-size="11">TreeDex â€” Tree-based Vectorless RAG</text>
</svg>
